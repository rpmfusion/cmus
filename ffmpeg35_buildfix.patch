--- a/ip/ffmpeg.c
+++ b/ip/ffmpeg.c
@@ -252,8 +252,8 @@
 			break;
 		}
 
-		if (codec->capabilities & CODEC_CAP_TRUNCATED)
-			cc->flags |= CODEC_FLAG_TRUNCATED;
+		if (codec->capabilities & AV_CODEC_CAP_TRUNCATED)
+			cc->flags |= AV_CODEC_FLAG_TRUNCATED;
 
 #if (LIBAVCODEC_VERSION_INT < ((53<<16)+(8<<8)+0))
 		if (avcodec_open(cc, codec) < 0) {

